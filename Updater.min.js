class GraphicsUpdater{constructor(e,t,s){this.settings=e,this.url="https://spreadsheets.google.com/feeds/cells/"+t+"/1/public/full?alt=json",this.keys={},s=s||2e3;for(let t of Object.keys(e))this.keys[t]=Object.keys(e[t]);this.update(),setInterval(this.update.bind(this),s)}async update(){try{let t=await fetch(this.url);if(!t.ok)throw"Failed to find your spreadsheet!";var e=await t.json()}catch(e){throw"Failed to access spreadsheet on Google Sheets API"}e=e.feed.entry;for(let t of e){let e,s=t.title.$t,l=t.content.$t;for(let t of Object.keys(this.keys))if(this.keys[t].includes(s)){e=t;break}if(!e)continue;let o=this.settings[e][s];if("string"===e)if("string"==typeof o)document.getElementById(o).innerHTML=l;else for(let e of o)document.getElementById(e).innerHTML=l;else if("image"===e)if("string"==typeof o)document.getElementById(o).src=l;else for(let e of o)document.getElementById(e).src=l;else if("counter"===e){try{l=parseInt(l)}catch(e){throw"Failed to parse number from spreadsheet: make sure it's a number!"}for(let e=0;e<l;e++)document.getElementById(o[e]).style.display="";for(let e=l;e<o.length;e++)document.getElementById(o[e]).style.display="none"}else if("switch"===e){let e=Object.keys(o);for(let t of e)document.getElementById(o[t]).style.display=t==l?"":"none"}}}}